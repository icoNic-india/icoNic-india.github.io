<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta name="author" content="icoNic" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="üß† Malware Series #2: Windows Memory for Malware Development (HeapAlloc Basics)" />
<meta property="og:description" content="üß† Malware Series #2: Windows Memory for Malware Development (HeapAlloc Basics)" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-30T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"icoNic"},"dateModified":"2025-08-30T00:00:00+00:00","datePublished":"2025-08-30T00:00:00+00:00","description":"üß† Malware Series #2: Windows Memory for Malware Development (HeapAlloc Basics)","mainEntityOfPage":{"@type":"WebPage","@id":"/2025/08/30/malware-series-2-windows-memory-management.html"},"url":"/2025/08/30/malware-series-2-windows-memory-management.html"}</script>
<!-- End Jekyll SEO tag -->


    <style>
    /* Mobile-friendly adjustment for floating Home button */
    @media (max-width: 600px) {
      a[style*="position: fixed"] {
        top: 10px;
        right: 10px;
        padding: 8px 12px;
        font-size: 14px;
      }
    }
    </style>
  </head>

  <body>
    <!-- Floating Home Button -->
    
  <!-- Floating Home Button -->
  <a href="/" 
     style="
       position: fixed;
       top: 20px;
       right: 20px;
       padding: 10px 16px;
       background-color: #111;
       color: #33ff33;
       border: 2px solid #33ff33;
       border-radius: 6px;
       font-family: 'Courier New', monospace;
       font-weight: bold;
       text-decoration: none;
       cursor: pointer;
       transition: all 0.2s ease-in-out;
       z-index: 9999;
     "
     onmouseover="this.style.backgroundColor='#33ff33'; this.style.color='#111';"
     onmouseout="this.style.backgroundColor='#111'; this.style.color='#33ff33';"
  >
     üè† Home
  </a>



    <!-- Page Content -->
    <div class="container">
      <section id="main_content">
        <small>30 August 2025</small>
<h1></h1>

<p class="view">by icoNic</p>

<div style="margin-bottom: 20px;">
  <button onclick="window.history.back();" 
          style="
            padding: 10px 16px; 
            background-color: #111; 
            color: #ff3333; 
            border: 2px solid #ff3333; 
            border-radius: 6px; 
            font-family: 'Courier New', monospace; 
            font-weight: bold; 
            cursor: pointer;
            transition: all 0.2s ease-in-out;
          "
          onmouseover="this.style.backgroundColor='#ff3333'; this.style.color='#111';"
          onmouseout="this.style.backgroundColor='#111'; this.style.color='#ff3333';"
  >
    ‚Üê Back
  </button>
</div>

<h1 id="-malware-series-2-windows-memory-for-malware-development-heapalloc-basics">üß† Malware Series #2: Windows Memory for Malware Development (HeapAlloc Basics)</h1>

<!-- ![Cover Picture](assets/images/windows-memory-management-cover-pic.jpeg) -->

<hr />

<h2 id="tldr">TL;DR</h2>
<ul>
  <li>Windows programs use <strong>virtual memory</strong>, not physical RAM directly.</li>
  <li>Memory can be <strong>Free</strong>, <strong>Reserved</strong>, or <strong>Committed</strong>.</li>
  <li>There are multiple ways to allocate memory (<code class="language-plaintext highlighter-rouge">malloc</code>, <code class="language-plaintext highlighter-rouge">HeapAlloc</code>, <code class="language-plaintext highlighter-rouge">LocalAlloc</code>), but in malware development <strong>HeapAlloc is the most commonly used</strong>.</li>
  <li>Always free memory after use (<code class="language-plaintext highlighter-rouge">HeapFree</code>) to avoid memory leaks.</li>
</ul>

<hr />

<h2 id="-introduction">üîπ Introduction</h2>
<p>In malware development (and reverse engineering), understanding <strong>how Windows handles memory</strong> is crucial.</p>

<p>While C provides <code class="language-plaintext highlighter-rouge">malloc()</code> and Windows also supports legacy <code class="language-plaintext highlighter-rouge">LocalAlloc()</code>, this post will focus <strong>primarily on <code class="language-plaintext highlighter-rouge">HeapAlloc()</code></strong> ‚Äî the function most malware samples use to allocate memory at runtime.</p>

<p>We‚Äôll look at:</p>
<ul>
  <li>What <code class="language-plaintext highlighter-rouge">HeapAlloc</code> does</li>
  <li>How it differs from <code class="language-plaintext highlighter-rouge">malloc</code> and <code class="language-plaintext highlighter-rouge">LocalAlloc</code></li>
  <li>Practical examples in C you can run in <strong>Visual Studio</strong></li>
  <li>How to inspect allocated memory in the <strong>Memory Window</strong></li>
</ul>

<hr />

<h2 id="-virtual-memory--paging">üîπ Virtual Memory &amp; Paging</h2>
<p>Windows doesn‚Äôt give programs direct access to RAM. Instead, each process gets a <strong>virtual address space</strong> which the OS maps to real RAM (or disk if needed).</p>

<ul>
  <li>Memory is split into <strong>pages</strong> (4 KB chunks).</li>
  <li>Pages can be swapped in/out of RAM.</li>
  <li>This allows isolation and security between processes.</li>
</ul>

<p><img src="/assets/images/virtual-memory-to-physical-memory.png" alt="Virtual Memory to Phyiscal Memory Mapping" />
<!-- ![Understanding User and Kernal Mode](/assets/images/user-kernal-mode.png)   -->
‚Äî</p>

<h2 id="-page-states">üîπ Page States</h2>
<p>Each page can be:</p>

<ol>
  <li><strong>Free</strong> ‚Üí Not used. If accessed, program crashes.</li>
  <li><strong>Reserved</strong> ‚Üí Set aside, but not yet tied to RAM.</li>
  <li><strong>Committed</strong> ‚Üí Backed by real memory (RAM or disk).</li>
</ol>

<p>Think of it like hotel rooms:</p>
<ul>
  <li>Free = no booking</li>
  <li>Reserved = booked but empty</li>
  <li>Committed = guest checked in</li>
</ul>

<p><img src="/assets/images/page-states.jpeg" alt="Page States" /></p>

<hr />

<hr />

<h2 id="-why-heapalloc">üîπ Why HeapAlloc?</h2>
<p>You might ask:</p>
<blockquote>
  <p>‚ÄúWhy use <code class="language-plaintext highlighter-rouge">HeapAlloc</code> when <code class="language-plaintext highlighter-rouge">malloc</code> already exists?‚Äù</p>
</blockquote>

<p>Here‚Äôs the difference:</p>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Defined In</th>
      <th>Zero-initialization?</th>
      <th>Common Use</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">malloc</code></td>
      <td>C Standard (<code class="language-plaintext highlighter-rouge">stdlib.h</code>)</td>
      <td>‚ùå No (garbage memory)</td>
      <td>Cross-platform C code</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">HeapAlloc</code></td>
      <td>Windows API (<code class="language-plaintext highlighter-rouge">windows.h</code>)</td>
      <td>‚úÖ With <code class="language-plaintext highlighter-rouge">HEAP_ZERO_MEMORY</code></td>
      <td>Windows-specific programs, malware</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">LocalAlloc</code></td>
      <td>Windows API (legacy)</td>
      <td>‚úÖ With <code class="language-plaintext highlighter-rouge">LMEM_ZEROINIT</code></td>
      <td>Mostly historical</td>
    </tr>
  </tbody>
</table>

<p>üëâ Malware authors prefer <strong><code class="language-plaintext highlighter-rouge">HeapAlloc</code></strong> because:</p>
<ul>
  <li>It allocates directly from the <strong>process heap</strong>.</li>
  <li>It can return <strong>zeroed memory</strong> with the <code class="language-plaintext highlighter-rouge">HEAP_ZERO_MEMORY</code> flag.</li>
  <li>It works well with other Windows APIs.</li>
</ul>

<hr />

<h2 id="-page-protection-options">üîπ Page Protection Options</h2>

<p>Once pages are <strong>committed</strong>, they must be assigned a <strong>protection option</strong>. These options define how the memory can be accessed and are crucial for both legitimate applications and malware behavior.</p>

<p>Some common protection constants:</p>

<table>
  <thead>
    <tr>
      <th>Protection Constant</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">PAGE_NOACCESS</code></td>
      <td>Disables all access. Any read/write/execute attempt causes an access violation.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">PAGE_EXECUTE_READWRITE</code></td>
      <td>Enables read, write, and execute. ‚ö†Ô∏è This is discouraged and often flagged as an <strong>Indicator of Compromise (IoC)</strong>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">PAGE_READONLY</code></td>
      <td>Allows only read access. Writing causes an access violation.</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-memory-protection-mechanisms">üîπ Memory Protection Mechanisms</h2>

<p>Modern Windows systems implement <strong>memory protection features</strong> to prevent exploits and malware execution:</p>

<ul>
  <li>
    <p><strong>Data Execution Prevention (DEP)</strong><br />
Prevents execution of code in non-executable memory regions. For example, if a page is marked <code class="language-plaintext highlighter-rouge">PAGE_READONLY</code>, DEP will block any attempt to run code from it.</p>
  </li>
  <li>
    <p><strong>Address Space Layout Randomization (ASLR)</strong><br />
Randomizes memory layout of key areas (stack, heap, libraries, etc.) to make it harder for attackers to predict memory addresses and exploit vulnerabilities.</p>
  </li>
</ul>

<hr />

<h2 id="-x86-vs-x64-memory-space">üîπ x86 vs x64 Memory Space</h2>

<p>Understanding the architecture is key:</p>

<table>
  <thead>
    <tr>
      <th>Architecture</th>
      <th>Max Addressable Memory</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">x86</code></td>
      <td>4 GB (<code class="language-plaintext highlighter-rouge">0xFFFFFFFF</code>)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">x64</code></td>
      <td>128 TB (<code class="language-plaintext highlighter-rouge">0xFFFFFFFFFFFFFFFF</code>)</td>
    </tr>
  </tbody>
</table>

<p>Malware targeting x64 systems must account for the <strong>vastly larger memory space</strong> and different calling conventions.</p>

<hr />

<h2 id="-allocating-memory-example">üîπ Allocating Memory Example</h2>

<p>In malware development, memory allocation is often done using the Windows API rather than standard C functions like <code class="language-plaintext highlighter-rouge">malloc</code>. One of the most commonly used functions is <code class="language-plaintext highlighter-rouge">HeapAlloc</code>.</p>

<h3 id="-code-example-allocating-memory-with-heapalloc">üß™ Code Example: Allocating Memory with <code class="language-plaintext highlighter-rouge">HeapAlloc</code></h3>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">PVOID</span> <span class="n">pAddress</span> <span class="o">=</span> <span class="n">HeapAlloc</span><span class="p">(</span><span class="n">GetProcessHeap</span><span class="p">(),</span> <span class="n">HEAP_ZERO_MEMORY</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"[+] Base Address of Allocated Memory : 0x%p </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">pAddress</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"[*] Press &lt;Enter&gt; to Quit"</span><span class="p">);</span>

    <span class="n">getchar</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/heapalloc.png" alt="HeapAlloc function" /></p>

<h2 id="-explanation">üîπ Explanation</h2>

<p>Here‚Äôs a breakdown of the <code class="language-plaintext highlighter-rouge">HeapAlloc</code> example:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">GetProcessHeap()</code></strong><br />
Retrieves a handle to the default heap of the calling process.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">HEAP_ZERO_MEMORY</code></strong><br />
Initializes all bytes in the allocated memory block to zero.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">HeapAlloc(..., ..., 100)</code></strong><br />
Allocates 100 bytes from the process heap.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">pAddress</code></strong><br />
Stores the base address of the allocated memory block.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">printf(...)</code></strong><br />
Displays the memory address in the console.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">getchar()</code></strong><br />
Waits for user input before exiting.</p>
  </li>
</ul>

<hr />

<h2 id="-heap_zero_memory-flag">üîπ <code class="language-plaintext highlighter-rouge">HEAP_ZERO_MEMORY</code> Flag</h2>

<p>The <code class="language-plaintext highlighter-rouge">HEAP_ZERO_MEMORY</code> flag ensures that the allocated memory is <strong>zero-initialized</strong>, which is especially useful in malware development to:</p>

<ul>
  <li>Avoid garbage data.</li>
  <li>Reduce detection risk.</li>
  <li>Prevent residual data from previous allocations.</li>
</ul>

<p>Without this flag, memory may contain unpredictable or sensitive remnants, which could lead to bugs or forensic artifacts.</p>

<hr />
<h2 id="-writing-to-allocated-memory">üîπ Writing to Allocated Memory</h2>

<p>Once memory is allocated using <code class="language-plaintext highlighter-rouge">HeapAlloc</code>, you can write data into it using functions like <code class="language-plaintext highlighter-rouge">memcpy</code>. Here‚Äôs a practical example:</p>

<h3 id="-code-example-writing-a-string-to-allocated-memory">üß™ Code Example: Writing a String to Allocated Memory</h3>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">PVOID</span> <span class="n">pAddress</span> <span class="o">=</span> <span class="n">HeapAlloc</span><span class="p">(</span><span class="n">GetProcessHeap</span><span class="p">(),</span> <span class="n">HEAP_ZERO_MEMORY</span><span class="p">,</span> <span class="mi">128</span><span class="p">);</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cString</span> <span class="o">=</span> <span class="s">"Learning with Iconic Hacks"</span><span class="p">;</span>

    <span class="c1">// Writing to the memory</span>
    <span class="n">memcpy</span><span class="p">(</span><span class="n">pAddress</span><span class="p">,</span> <span class="n">cString</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">cString</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"[+] Allocated Memory Address: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">pAddress</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"[+] Allocated Memory Content: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">pAddress</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"Press &lt;Enter&gt; to Quit "</span><span class="p">);</span>
    
    <span class="n">getchar</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/writing%20to%20memory%20with%20memcpy.png" alt="Memcpy Function" /></p>

<h2 id="-explanation-1">üîπ Explanation</h2>

<p>Let‚Äôs break down what the code is doing step-by-step:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">HeapAlloc(..., HEAP_ZERO_MEMORY, 128)</code></strong><br />
Allocates 128 bytes of memory from the process heap and initializes it to zero using the <code class="language-plaintext highlighter-rouge">HEAP_ZERO_MEMORY</code> flag.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">const char *cString = "Learning with Iconic Hacks";</code></strong><br />
Declares a string literal that will be written into the allocated memory.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">memcpy(pAddress, cString, strlen(cString) + 1);</code></strong><br />
Copies the string into the allocated memory. The <code class="language-plaintext highlighter-rouge">+1</code> ensures the null terminator is included.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">printf("[+] Allocated Memory Address: %p\n", pAddress);</code></strong><br />
Prints the base address of the allocated memory block.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">printf("[+] Allocated Memory Content: %s\n", (char*)pAddress);</code></strong><br />
Prints the actual content stored at that memory location.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">getchar();</code></strong><br />
Pauses the program until the user presses Enter, allowing time to inspect memory in tools like the Memory Window.</p>
  </li>
</ul>

<hr />

<h2 id="-memory-viewer-output">üîπ Memory Viewer Output</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>In the memory viewer, you‚Äôll see:

- Address: 0000028DDFD125F0  
- Content: "Learning with Iconic Hacks"  
- Hex Representation:  4C 65 61 72 6E 69 6E 67 20 77 69 74 68 20 49 63 6F 6E 69 63 20 48 61 63 6B 73 ...

</code></pre></div></div>

<h2 id="-freeing-allocated-memory">üîπ Freeing Allocated Memory</h2>

<p>After allocating and using memory, it‚Äôs important to <strong>release it properly</strong> to avoid memory leaks ‚Äî especially in malware development where stealth and resource management are critical.</p>

<h3 id="-code-example-freeing-memory-with-heapfree">üß™ Code Example: Freeing Memory with <code class="language-plaintext highlighter-rouge">HeapFree</code></h3>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">PVOID</span> <span class="n">pAddress</span> <span class="o">=</span> <span class="n">HeapAlloc</span><span class="p">(</span><span class="n">GetProcessHeap</span><span class="p">(),</span> <span class="n">HEAP_ZERO_MEMORY</span><span class="p">,</span> <span class="mi">128</span><span class="p">);</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">cString</span> <span class="o">=</span> <span class="s">"Learning with Iconic Hacks"</span><span class="p">;</span>

    <span class="c1">// Writing to the memory</span>
    <span class="n">memcpy</span><span class="p">(</span><span class="n">pAddress</span><span class="p">,</span> <span class="n">cString</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">cString</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"[+] Allocated Memory Address: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">pAddress</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"[+] Allocated Memory Content: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">pAddress</span><span class="p">);</span>

    <span class="c1">// Freeing the allocated memory</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"[-] Freeing the allocated memory...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">HeapFree</span><span class="p">(</span><span class="n">GetProcessHeap</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pAddress</span><span class="p">);</span>

    <span class="c1">// Pause the console for checking the address content after freeing the memory</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Press &lt;Enter&gt; to quit "</span><span class="p">);</span>
    
    <span class="n">getchar</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p><img src="/assets/images/Pausing%20at%20heapfree.png" alt="Pausing Free Memory" />
<img src="/assets/images/freeing%20memory%20after%20heapalloc.png" alt="Free Memory Function" /></p>

<h2 id="-explanation-2">üîç Explanation</h2>

<p>Let‚Äôs break down the memory management flow step-by-step:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">HeapAlloc(..., HEAP_ZERO_MEMORY, 128)</code></strong><br />
Allocates 128 bytes of memory from the process heap and initializes it to zero. This ensures no garbage data is present in the block.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">const char* cString = "Learning with Iconic Hacks";</code></strong><br />
Declares a string that will be written into the allocated memory.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">memcpy(...)</code> or <code class="language-plaintext highlighter-rouge">strcpy(...)</code></strong><br />
Copies the string into the allocated memory. The <code class="language-plaintext highlighter-rouge">+1</code> in <code class="language-plaintext highlighter-rouge">strlen(cString) + 1</code> ensures the null terminator is included.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">printf(...)</code></strong><br />
Displays both the memory address and the content stored at that address.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">HeapFree(GetProcessHeap(), 0, pAddress);</code></strong><br />
Frees the allocated memory block, returning it to the heap. This is essential to avoid memory leaks and reduce forensic traces.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">getchar();</code></strong><br />
Pauses the program, allowing time to inspect the memory content after freeing.</p>
  </li>
</ul>

<hr />

<h2 id="Ô∏è-console-output">üñ•Ô∏è Console Output</h2>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[+] Allocated Memory Address: 000001F8B2E5D250
[+] Allocated Memory Content: Learning with Iconic Hacks
[-] Freeing the allocated memory...
Press &lt;Enter&gt; to quit
</code></pre></div></div>

<h2 id="-memory-viewer-output-1">üß† Memory Viewer Output</h2>
<p>Even after freeing, the memory viewer may still show the previous content temporarily. However, accessing freed memory is undefined behavior and can lead to crashes or security vulnerabilities.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Address: 000001F4D6E52FD0
Hex: 4C 65 61 72 6E 69 6E 67 20 77 69 74 68 20 49 63 6F 6E 69 63 20 48 61 63 6B 73
ASCII: Learning with Iconic Hacks
</code></pre></div></div>



  <small>tags: <em>windows</em> - <em>malware</em> - <em>kernel</em> - <em>user-mode</em> - <em>cybersecurity</em> - <em>reverse-engineering</em> - <em>hack</em> - <em>analysis</em></small>


      </section>
    </div>

    <!-- Global Footer (ALWAYS shows on every page) -->
    <footer style="text-align: center; padding: 1rem; background: #161b22; font-size: 0.9rem; color: #8b949e; border-top: 2px solid #30363d; margin-top: 2rem;">
      ‚ö° ‚ÄúLearning never exhausts the mind.‚Äù ‚Äî Leonardo da Vinci <br>
      ¬© 2025 Iconic Hacks. All rights reserved.
    </footer>
  </body>
</html>
